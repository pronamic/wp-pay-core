!function(t){var a=function(a){var i=this,e=t(a),n={};n.variantId=e.find("#pronamic_gateway_id"),n.extraSettings=e.find("div.extra-settings"),n.sectionHeaders=e.find(".gateway-config-section-header"),n.tabs=e.find(".pronamic-pay-tabs"),n.tabItems=e.find("ul.pronamic-pay-tabs-items"),this.updateFields=function(){i.selectedVariant=n.variantId.find("option:selected"),i.settings=i.selectedVariant.data("pronamic-pay-settings"),e.find(".extra-settings").hide(),i.settingElements=[],t.isArray(i.settings)&&t.each(i.settings,(function(t,a){e.find(".setting-"+a).show()})),e.find(".setting-"+i.selectedVariant.val()).show();var a=i.selectedVariant.text().split(" - ")[0].replace(/ \(.*\)/,"");n.tabItems.find(":visible").first().text(a).click(),t("#pronamic-pay-gateway-description").html(i.selectedVariant.attr("data-gateway-description"))},this.updateRowBackgroundColor=function(){var t=n.extraSettings.find(".form-table tr");t.removeClass("even"),t.filter(":visible:even").addClass("even")},this.initTabs=function(){t.each(n.sectionHeaders,(function(a,i){var e=t(i),s=e.find("h4").text(),o=e.parents("div")[0].className;n.tabItems.append(t("<li>"+s+"</li>").addClass(o).removeClass("pronamic-pay-tab"))})),n.tabItems.next().after(n.tabItems),n.tabItems.find("li").click(i.showTabSettings)},this.showTabSettings=function(){var a=t(this);n.extraSettings.hide().eq(a.index()).show()};var s=function(){t.ajax({url:pronamicPayGatewayAdmin.rest_url,method:"GET",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",pronamicPayGatewayAdmin.nonce)},data:{gateway_id:t("#pronamic_gateway_id").val(),gateway_mode:t("#pronamic_ideal_mode").val()}}).done((function(a){t("#pronamic-pay-gateway-settings").html(a.meta_boxes.settings),t("#pronamic-pay-gateway-settings .pronamic-pay-tabs").pronamicPayTabs(),t("#pronamic-pay-gateway-settings .pronamic-pay-tip").each((function(){tippy(this,{content:t(this).attr("title"),arrow:!0,theme:"pronamic-pay"})}))}))};t("#pronamic_gateway_id").change(s),t("#pronamic_ideal_mode").change(s),i.initTabs(),i.updateFields(),n.variantId.change(i.updateFields)};t.fn.pronamicPayGatewayConfigEditor=function(){return this.each((function(){var i=t(this);if(!i.data("pronamic-pay-gateway-config-editor")){var e=new a(this);i.data("pronamic-pay-gateway-config-editor",e)}}))};var i=function(a){var i=this,e=t(a),n={};n.tabItems=e.find("ul.pronamic-pay-tabs-items"),n.tabs=e.find(".pronamic-pay-tab"),n.tabItems=e.find("ul.pronamic-pay-tabs-items"),this.updateRowBackgroundColor=function(){var t=n.tabs.find(".form-table tr");t.removeClass("even"),t.filter(":visible:even").addClass("even")},this.showTab=function(){var a=t(this);n.tabItems.find("li").removeClass("active"),a.addClass("active"),n.tabs.hide().eq(a.index()).show(),i.updateRowBackgroundColor(),i.visibleTabItems=n.tabItems.find("li:visible"),i.activeTabItem=a},this.responsiveTabs=function(){if(t(window).width()>960)n.tabs.hide(),i.activeTabItem?i.activeTabItem.click():n.tabItems.find("li:visible").first().click();else{if(!i.visibleTabItems)return;n.tabs.hide(),t.each(i.visibleTabItems,(function(a,i){n.tabs.eq(t(i).index()).show()}))}},n.tabItems.find("li").click(i.showTab),n.tabItems.find("li:visible").first().click(),t(window).resize(i.responsiveTabs)};t.fn.pronamicPayTabs=function(){return this.each((function(){var a=t(this);if(!a.data("pronamic-pay-tabs")){var e=new i(this);a.data("pronamic-pay-tabs",e)}}))};var e=function(a){var i=t(a);i.siblings("a.edit-pronamic-pay-post-status").on("click",(function(a){i.is(":hidden")&&(i.slideDown("fast",(function(){i.find("select").trigger("focus")})),t(this).hide()),a.preventDefault()})),i.find(".save-pronamic-pay-post-status").on("click",(function(a){i.slideUp("fast").siblings("a.edit-pronamic-pay-post-status").show().trigger("focus"),t("#pronamic-pay-status-display").text(t("#pronamic-pay-post-status option:selected").text()),a.preventDefault()})),i.find(".cancel-pronamic-pay-post-status").on("click",(function(a){i.slideUp("fast").siblings("a.edit-pronamic-pay-post-status").show().trigger("focus"),t("#pronamic-pay-post-status").val(t("#hidden_pronamic_pay_post_status").val()),t("#pronamic-pay-status-display").text(t("#pronamic-pay-post-status option:selected").text()),a.preventDefault()}))};t.fn.pronamicPayPostStatus=function(){return this.each((function(){var a=t(this);if(!a.data("pronamic-pay-post-status")){var i=new e(this);a.data("pronamic-pay-post-status",i)}}))};var n=function(a){var i=t(a),e={};e.paymentMethods=i.find('select[name="pronamic_pay_test_payment_method"]'),this.updateInputVisibility=function(){var a=e.paymentMethods.val();""!==a&&i.find(".pronamic-pay-test-payment-method").hide().filter("."+a).show(),1===e.paymentMethods.find("option:selected").data("is-recurring")?t("#pronamic-pay-test-subscription").parents("tr").show():(t("#pronamic-pay-test-subscription").parents("tr").hide(),t("#pronamic-pay-test-subscription").prop("checked",!1).trigger("change"))},this.updateInputVisibility(),e.paymentMethods.change(this.updateInputVisibility),i.on("keydown","input, select",(function(t){13===t.keyCode&&(t.preventDefault(),i.find('input[name="test_pay_gateway"]').click())}))};t.fn.pronamicPayGatewayTest=function(){return this.each((function(){var a=t(this);if(!a.data("pronamic-pay-gateway-test")){var i=new n(this);a.data("pronamic-pay-gateway-test",i)}}))};var s=function(a){var i=this,e=t(a),n={};n.amountMethod=e.find('select[name="_pronamic_payment_form_amount_method"]'),this.updateAmountsVisibility=function(){var t=n.amountMethod.val();"choices_only"===t||"choices_and_input"===t?e.find('input[name="_pronamic_payment_form_amount_choices[]"]').closest("div").show():e.find('input[name="_pronamic_payment_form_amount_choices[]"]').closest("div").hide()},this.maybeAddAmountChoice=function(){if(n.amountChoices=e.find('input[name="_pronamic_payment_form_amount_choices[]"]'),0===n.amountChoices.filter((function(){return""===this.value})).length){var t=n.amountChoices.last().closest("div"),a=t.clone(),i="_pronamic_payment_form_amount_choice_"+n.amountChoices.length;a.find("input").attr("id",i).val(""),a.find("label").attr("for",i),t.after(a)}},i.updateAmountsVisibility(),n.amountMethod.change(i.updateAmountsVisibility),e.on("keyup",'input[name="_pronamic_payment_form_amount_choices[]"]',(function(){i.maybeAddAmountChoice()}))};t.fn.pronamicPayFormOptions=function(){return this.each((function(){var a=t(this);if(!a.data("pronamic-pay-forms-options")){var i=new s(this);a.data("pronamic-pay-form-options",i)}}))},t(document).ready((function(){t("#pronamic-pay-gateway-config-editor").pronamicPayGatewayConfigEditor(),t("#pronamic_payment_form_options").pronamicPayFormOptions(),t("#pronamic-pay-post-status-select").pronamicPayPostStatus(),t("#pronamic_gateway_test").pronamicPayGatewayTest(),t(".pronamic-pay-tabs").pronamicPayTabs(),t(".pronamic-pay-tip").each((function(){tippy(this,{content:t(this).attr("title"),arrow:!0,theme:"pronamic-pay"})}))}))}(jQuery);